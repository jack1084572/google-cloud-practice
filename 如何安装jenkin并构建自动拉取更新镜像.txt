æ–¹æ³•ä¸€ï¼šç”¨ Docker åœ¨ Cloud Shell ä¸­è¿è¡Œ Jenkinsï¼ˆæ¨èï¼‰
ğŸ§± å‰æï¼šCloud Shell ä¸­å·²å†…ç½® Docker
ğŸš€ æ­¥éª¤ä¸€ï¼šæ‹‰å–å®˜æ–¹ Jenkins é•œåƒ
bash
å¤åˆ¶
ç¼–è¾‘
docker pull jenkins/jenkins:lts
ğŸš€ æ­¥éª¤äºŒï¼šè¿è¡Œ Jenkins å®¹å™¨ï¼ˆç»‘å®šç«¯å£ + æŒä¹…åŒ–ï¼‰
bash
å¤åˆ¶
ç¼–è¾‘
docker run -d \
  -p 8080:8080 \
  -p 50000:50000 \
  -v jenkins_home:/var/jenkins_home \
  --name jenkins \
  jenkins/jenkins:lts
-p 8080:8080ï¼šæ˜ å°„ Jenkins ç½‘é¡µç«¯å£

-v jenkins_home:/var/jenkins_homeï¼šä½¿ç”¨æŒä¹…åŒ–å·ï¼ˆé‡å¯é•œåƒæ•°æ®ä¸ä¸¢ï¼‰

-dï¼šåå°è¿è¡Œ

--name jenkinsï¼šå®¹å™¨å‘½åä¸º jenkins

ğŸš€ æ­¥éª¤ä¸‰ï¼šè®¿é—® Jenkins ç½‘é¡µç•Œé¢
ç‚¹å‡» Cloud Shell é¡¶éƒ¨çš„ã€ŒWeb é¢„è§ˆ â†’ é¢„è§ˆç«¯å£ 8080ã€

æˆ–è€…æ‰“å¼€ URLï¼š

cpp
å¤åˆ¶
ç¼–è¾‘
https://8080-dot-YOUR-SESSION-ID.developers.devshell.appspot.com
ğŸ”‘ è·å–åˆå§‹ç®¡ç†å‘˜å¯†ç 
bash
å¤åˆ¶
ç¼–è¾‘
docker exec -it jenkins cat /var/jenkins_home/secrets/initialAdminPassword
å¤åˆ¶å¯†ç  â†’ ç²˜è´´åˆ° Jenkins åˆå§‹åŒ–é¡µé¢ä¸­ã€‚



æ–¹æ³•ä¸€ï¼šç›´æ¥è¯»å–å¯†ç ï¼ˆæ¨èï¼‰
bash
å¤åˆ¶
ç¼–è¾‘
docker exec -it jenkins cat /var/jenkins_home/secrets/initialAdminPassword
è¿™æ¡å‘½ä»¤ä¼šè¾“å‡ºä¸€é•¿ä¸²å¯†ç ï¼Œå¤åˆ¶åç²˜è´´åˆ° Jenkins çš„ç½‘é¡µç•Œé¢ä¸Šå³å¯å®Œæˆé¦–æ¬¡ç™»å½•ã€‚

æ–¹æ³•äºŒï¼šè¿›å…¥ Jenkins å®¹å™¨å†…éƒ¨
ä½ ä¹Ÿå¯ä»¥ç”¨äº¤äº’æ–¹å¼è¿›å…¥ Jenkins å®¹å™¨ï¼š

bash
å¤åˆ¶
ç¼–è¾‘
docker exec -it jenkins bash
ç„¶ååœ¨å®¹å™¨å†…è¿è¡Œï¼š

bash
å¤åˆ¶
ç¼–è¾‘
cat /var/jenkins_home/secrets/initialAdminPassword
çœ‹åˆ°å¯†ç åå¯ä»¥è¾“å…¥ï¼š

bash
å¤åˆ¶
ç¼–è¾‘
exit
è¡¥å……è¯´æ˜
jenkins æ˜¯ä½ å®¹å™¨çš„åå­—ï¼Œå¦‚æœä½ ç”¨çš„æ˜¯å…¶ä»–åå­—ï¼ˆæ¯”å¦‚ myjenkinsï¼‰ï¼Œè¯·æ›¿æ¢æˆå®é™…å®¹å™¨åã€‚

å¦‚æœä½ å¿˜äº†å®¹å™¨åï¼Œå¯ä»¥ç”¨ï¼š

bash
å¤åˆ¶
ç¼–è¾‘
docker ps


æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Docker å¯åŠ¨ GitLabï¼ˆæ¨èï¼‰
docker run --detach \
  --hostname gitlab.local \
  --publish 9090:80 \
  --name gitlab2 \     # ğŸ‘ˆ æ”¹åä¸º gitlab2
  --restart always \
  --shm-size 2g \
  --volume $HOME/gitlab/config:/etc/gitlab \
  --volume $HOME/gitlab/logs:/var/log/gitlab \
  --volume $HOME/gitlab/data:/var/opt/gitlab \
  gitlab/gitlab-ce:latest


2. å¯åŠ¨å®¹å™¨

docker start f6f72de5091ec974d41335b7313fa66a4ff463170b04c853c0e5b75dba2954f9

docker start GitLab

GitLab Docker å®¹å™¨é‡Œé‡ç½® root å¯†ç æ–¹æ³•

docker exec -it gitlab /bin/bash

gitlab-rails console -e production

user = User.find_by_username('root')
user.password = 'your_new_password'
user.password_confirmation = 'your_new_password'
user.save!

exit



å¯åŠ¨jenkinå¹¶æŒ‡å®šç«¯å£
nohup java -jar jenkins.war --httpPort=8080 &
